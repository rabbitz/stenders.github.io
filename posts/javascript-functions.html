<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>JavaScript功能函数收集</title>
  <link rel="stylesheet" href="/css/font-awesome.min.css" />
  <link rel="stylesheet" href="/css/default.css" />
  <link rel="stylesheet" href="/css/index.css" />
  <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
  <![endif]-->
</head>
<body>
<header>
  <nav class="container">
    <ul class="nav nav-pills pull-right">
      <li class="active"><a href="/">Home</a></li>
      <!-- <li><a href="./resume.html">About</a></li> -->
    </ul>
    <h3 class="text-muted"><a href="/">砸牛顿的大苹果</a></h3>
  </nav>
</header>
<div class="container">
  <div class="row marketing">
      <h2><a href="javascript:location.reload();">JavaScript功能函数收集</a></h2>

<p>这些函数方法都是看《JavaScript模式》学到的，jQuery里也大部分都有对应的实现，而这些是原生方法，今天有空就将它们记录下来，先写10个，以后再继续补充。</p>

<h4 id="一针对对象或数组的复制">一、针对对象或数组的复制</h4>

<h5 id="浅复制">1.浅复制</h5>

<pre class="prettyprint prettyprinted" style=""><code class="language-javascript"><span class="kwd">function</span><span class="pln"> extend</span><span class="pun">(</span><span class="pln">parent</span><span class="pun">,</span><span class="pln"> child</span><span class="pun">){</span><span class="pln">
    child </span><span class="pun">=</span><span class="pln"> child </span><span class="pun">||</span><span class="pln"> </span><span class="pun">{};</span><span class="pln"> </span><span class="com">// child不存在则新建空白对象</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">var</span><span class="pln"> i </span><span class="kwd">in</span><span class="pln"> parent</span><span class="pun">){</span><span class="pln">
        </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">parent</span><span class="pun">.</span><span class="pln">hasOwnProperty</span><span class="pun">(</span><span class="pln">i</span><span class="pun">)){</span><span class="pln">
            child</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> parent</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> child</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span></code></pre>

<h5 id="深复制">2.深复制</h5>

<pre class="prettyprint prettyprinted" style=""><code class="language-javascript"><span class="kwd">function</span><span class="pln"> deepExtend</span><span class="pun">(</span><span class="pln">parent</span><span class="pun">,</span><span class="pln"> child</span><span class="pun">){</span><span class="pln">
    child </span><span class="pun">=</span><span class="pln"> child </span><span class="pun">||</span><span class="pln"> </span><span class="pun">{};</span><span class="pln">
    </span><span class="kwd">var</span><span class="pln"> tostr </span><span class="pun">=</span><span class="pln"> child</span><span class="pun">.</span><span class="pln">toString</span><span class="pun">;</span><span class="pln"> </span><span class="com">// Object.prototype.toString</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">var</span><span class="pln"> i </span><span class="kwd">in</span><span class="pln"> parent</span><span class="pun">){</span><span class="pln">
        </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">parent</span><span class="pun">.</span><span class="pln">hasOwnProperty</span><span class="pun">(</span><span class="pln">i</span><span class="pun">)){</span><span class="pln">
            </span><span class="kwd">if</span><span class="pun">(</span><span class="kwd">typeof</span><span class="pln"> parent</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">===</span><span class="pln"> </span><span class="str">'object'</span><span class="pun">){</span><span class="pln"> </span><span class="com">// 如果parent[i]为对象</span><span class="pln">
                child</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">tostr</span><span class="pun">.</span><span class="pln">call</span><span class="pun">(</span><span class="pln">parent</span><span class="pun">[</span><span class="pln">i</span><span class="pun">])</span><span class="pln"> </span><span class="pun">===</span><span class="pln"> </span><span class="str">'[object Array]'</span><span class="pun">)</span><span class="pln"> </span><span class="pun">?</span><span class="pln"> </span><span class="pun">[]</span><span class="pln"> </span><span class="pun">:</span><span class="pln"> </span><span class="pun">{};</span><span class="pln"> </span><span class="com">// 根据情况赋值空白数组或空白对象</span><span class="pln">
                deepExtend</span><span class="pun">(</span><span class="pln">parent</span><span class="pun">[</span><span class="pln">i</span><span class="pun">],</span><span class="pln"> child</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]);</span><span class="pln"> </span><span class="com">// 进行递归复制</span><span class="pln">
            </span><span class="pun">}</span><span class="pln"> </span><span class="kwd">else</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
                child</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> parent</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="pln">
            </span><span class="pun">}</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> child</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="kwd">var</span><span class="pln"> a </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{</span><span class="str">'aaa'</span><span class="pun">:</span><span class="lit">111</span><span class="pun">,</span><span class="str">'bbb'</span><span class="pun">:</span><span class="lit">222</span><span class="pun">,</span><span class="str">'ccc'</span><span class="pun">:[</span><span class="lit">1</span><span class="pun">,</span><span class="lit">2</span><span class="pun">,</span><span class="lit">3</span><span class="pun">,[</span><span class="lit">4</span><span class="pun">,</span><span class="lit">5</span><span class="pun">,</span><span class="lit">6</span><span class="pun">,[</span><span class="lit">7</span><span class="pun">,</span><span class="lit">8</span><span class="pun">,</span><span class="lit">9</span><span class="pun">]]],</span><span class="str">'ddd'</span><span class="pun">:{</span><span class="str">'ss'</span><span class="pun">:</span><span class="lit">1</span><span class="pun">,</span><span class="str">'dd'</span><span class="pun">:</span><span class="lit">2</span><span class="pun">,</span><span class="str">'ee'</span><span class="pun">:{</span><span class="str">'ff'</span><span class="pun">:</span><span class="lit">33</span><span class="pun">,</span><span class="str">'gg'</span><span class="pun">:</span><span class="lit">55</span><span class="pun">}}};</span></code></pre>

<h5 id="利用json实现深复制的巧妙方法via-新浪微博">3.利用JSON实现深复制的巧妙方法（via 新浪微博）</h5>

<pre class="prettyprint prettyprinted" style=""><code class="language-javascript"><span class="kwd">function</span><span class="pln"> jsonExtend</span><span class="pun">(</span><span class="pln">parent</span><span class="pun">){</span><span class="pln">
    </span><span class="kwd">var</span><span class="pln"> str </span><span class="pun">=</span><span class="pln"> JSON</span><span class="pun">.</span><span class="pln">stringify</span><span class="pun">(</span><span class="pln">parent</span><span class="pun">);</span><span class="pln"> </span><span class="com">// 转化成字符串</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> JSON</span><span class="pun">.</span><span class="pln">parse</span><span class="pun">(</span><span class="pln">str</span><span class="pun">);</span><span class="pln"> </span><span class="com">// 转化成对象</span><span class="pln">
</span><span class="pun">}</span></code></pre>

<h4 id="二原型继承">二、原型继承</h4>

<pre class="prettyprint prettyprinted" style=""><code class="language-javascript"><span class="kwd">function</span><span class="pln"> create</span><span class="pun">(</span><span class="pln">o</span><span class="pun">){</span><span class="pln">
    </span><span class="kwd">function</span><span class="pln"> f</span><span class="pun">(){}</span><span class="pln">
    f</span><span class="pun">.</span><span class="pln">prototype </span><span class="pun">=</span><span class="pln"> o</span><span class="pun">;</span><span class="pln"> </span><span class="com">// 将o设置为代理函数的原型</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> f</span><span class="pun">;</span><span class="pln">  </span><span class="com">// 返回新的空对象，原型为对象o</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">function</span><span class="pln"> </span><span class="typ">Parent</span><span class="pun">(){</span><span class="pln">
    </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">name </span><span class="pun">=</span><span class="pln"> </span><span class="str">'papa'</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">age </span><span class="pun">=</span><span class="pln"> </span><span class="str">'28'</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="typ">Parent</span><span class="pun">.</span><span class="pln">prototype</span><span class="pun">.</span><span class="pln">say </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">function</span><span class="pun">(){</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> </span><span class="str">'I am '</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">name </span><span class="pun">+</span><span class="pln"> </span><span class="str">', and I am '</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">age </span><span class="pun">+</span><span class="pln"> </span><span class="str">' years old.'</span><span class="pun">;</span><span class="pln">
</span><span class="pun">};</span><span class="pln">
</span><span class="kwd">var</span><span class="pln"> parent </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">Parent</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">var</span><span class="pln"> luck </span><span class="pun">=</span><span class="pln"> create</span><span class="pun">(</span><span class="pln">parent</span><span class="pun">);</span><span class="pln"> </span><span class="com">// luck已具有parent的属性（name、age）与方法（say）</span></code></pre>

<h4 id="三类继承">三、类继承</h4>

<pre class="prettyprint prettyprinted" style=""><code class="language-javascript"><span class="kwd">function</span><span class="pln"> inherit</span><span class="pun">(</span><span class="pln">parent</span><span class="pun">,</span><span class="pln"> child</span><span class="pun">){</span><span class="pln">
    </span><span class="kwd">function</span><span class="pln"> F</span><span class="pun">(){}</span><span class="pln">
    F</span><span class="pun">.</span><span class="pln">prototype </span><span class="pun">=</span><span class="pln"> parent</span><span class="pun">.</span><span class="pln">prototype</span><span class="pun">;</span><span class="pln"> </span><span class="com">// 将超类与代理函数共享原型</span><span class="pln">
    child</span><span class="pun">.</span><span class="pln">prototype </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> F</span><span class="pun">;</span><span class="pln"> </span><span class="com">// 新建空对象作为child原型</span><span class="pln">
    child</span><span class="pun">.</span><span class="pln">uber </span><span class="pun">=</span><span class="pln"> parent</span><span class="pun">.</span><span class="pln">prototype</span><span class="pun">;</span><span class="pln"> </span><span class="com">// 在child上保存超类的原型</span><span class="pln">
    child</span><span class="pun">.</span><span class="pln">prototype</span><span class="pun">.</span><span class="pln">constructor </span><span class="pun">=</span><span class="pln"> child</span><span class="pun">;</span><span class="pln"> </span><span class="com">// 重置child的constructor指针</span><span class="pln">
</span><span class="pun">}</span></code></pre>

<h4 id="四事件绑定兼容ie与wc模式">四、事件绑定兼容IE与W3C模式</h4>

<pre class="prettyprint prettyprinted" style=""><code class="language-javascript"><span class="kwd">var</span><span class="pln"> </span><span class="typ">Utility</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    addEvent </span><span class="pun">:</span><span class="pln"> </span><span class="kwd">null</span><span class="pun">,</span><span class="pln">
    removeEvent </span><span class="pun">:</span><span class="pln"> </span><span class="kwd">null</span><span class="pln">
</span><span class="pun">};</span><span class="pln">
</span><span class="pun">(</span><span class="kwd">function</span><span class="pun">(){</span><span class="pln">
    </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">window</span><span class="pun">.</span><span class="pln">addEventListener</span><span class="pun">){</span><span class="pln"> </span><span class="com">// W3C模式</span><span class="pln">
        </span><span class="typ">Utility</span><span class="pun">.</span><span class="pln">addEvent </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">function</span><span class="pun">(</span><span class="pln">ele</span><span class="pun">,</span><span class="pln"> type</span><span class="pun">,</span><span class="pln"> handler</span><span class="pun">){</span><span class="pln">
            ele</span><span class="pun">.</span><span class="pln">addEventListener</span><span class="pun">(</span><span class="pln">type</span><span class="pun">,</span><span class="pln"> handler</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">false</span><span class="pun">);</span><span class="pln">
        </span><span class="pun">};</span><span class="pln">
        </span><span class="typ">Utility</span><span class="pun">.</span><span class="pln">removeEvent </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">function</span><span class="pun">(</span><span class="pln">ele</span><span class="pun">,</span><span class="pln"> type</span><span class="pun">,</span><span class="pln"> handler</span><span class="pun">){</span><span class="pln">
            ele</span><span class="pun">.</span><span class="pln">removeEventListender</span><span class="pun">(</span><span class="pln">type</span><span class="pun">,</span><span class="pln"> handler</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">false</span><span class="pun">);</span><span class="pln">
        </span><span class="pun">};</span><span class="pln">
    </span><span class="pun">}</span><span class="pln"> </span><span class="kwd">else</span><span class="pln"> </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">window</span><span class="pun">.</span><span class="pln">attachEvent</span><span class="pun">){</span><span class="pln"> </span><span class="com">// IE6+ 模式</span><span class="pln">
        </span><span class="typ">Utility</span><span class="pun">.</span><span class="pln">addEvent </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">function</span><span class="pun">(</span><span class="pln">ele</span><span class="pun">,</span><span class="pln"> type</span><span class="pun">,</span><span class="pln"> handler</span><span class="pun">){</span><span class="pln">
            ele</span><span class="pun">.</span><span class="pln">attachEvent</span><span class="pun">(</span><span class="str">'on'</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> type</span><span class="pun">,</span><span class="pln"> handler</span><span class="pun">);</span><span class="pln">
        </span><span class="pun">};</span><span class="pln">
        </span><span class="typ">Utility</span><span class="pun">.</span><span class="pln">removeEvent </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">function</span><span class="pun">(</span><span class="pln">ele</span><span class="pun">,</span><span class="pln"> type</span><span class="pun">,</span><span class="pln"> handler</span><span class="pun">){</span><span class="pln">
            ele</span><span class="pun">.</span><span class="pln">detachEvent</span><span class="pun">(</span><span class="str">'on'</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> type</span><span class="pun">,</span><span class="pln"> handler</span><span class="pun">);</span><span class="pln">
        </span><span class="pun">};</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
</span><span class="pun">})();</span></code></pre>

<h4 id="五函数context绑定">五、函数context绑定</h4>

<pre class="prettyprint prettyprinted" style=""><code class="language-javascript"><span class="kwd">function</span><span class="pln"> proxy</span><span class="pun">(</span><span class="pln">context</span><span class="pun">,</span><span class="pln"> fn</span><span class="pun">){</span><span class="pln"> </span><span class="com">// 支持两种参数方法(obj, obj.mothod)、(obj,'method')</span><span class="pln">
    </span><span class="kwd">var</span><span class="pln"> slice </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Array</span><span class="pun">.</span><span class="pln">prototype</span><span class="pun">.</span><span class="pln">slice</span><span class="pun">,</span><span class="pln"> </span><span class="com">// 缓存slice方法</span><span class="pln">
        args </span><span class="pun">=</span><span class="pln"> slice</span><span class="pun">.</span><span class="pln">call</span><span class="pun">(</span><span class="pln">arguments</span><span class="pun">,</span><span class="pln"> </span><span class="lit">2</span><span class="pun">);</span><span class="pln"> </span><span class="com">// 分离出参数</span><span class="pln">
    </span><span class="kwd">if</span><span class="pun">(</span><span class="kwd">typeof</span><span class="pln"> fn </span><span class="pun">===</span><span class="pln"> </span><span class="str">'string'</span><span class="pun">){</span><span class="pln"> </span><span class="com">// 如果为第二种形式</span><span class="pln">
        fn </span><span class="pun">=</span><span class="pln"> context</span><span class="pun">[</span><span class="pln">fn</span><span class="pun">];</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">function</span><span class="pun">(){</span><span class="pln"> </span><span class="com">// 返回应用了context为执行环境的fn，并合并任意数量参数</span><span class="pln">
        fn</span><span class="pun">.</span><span class="pln">apply</span><span class="pun">(</span><span class="pln">context</span><span class="pun">,</span><span class="pln"> args</span><span class="pun">.</span><span class="pln">concat</span><span class="pun">(</span><span class="pln">slice</span><span class="pun">.</span><span class="pln">call</span><span class="pun">(</span><span class="pln">arguments</span><span class="pun">)));</span><span class="pln">
    </span><span class="pun">};</span><span class="pln">
</span><span class="pun">}</span></code></pre>

<h4 id="六函数curry化通用函数">六、函数curry化通用函数</h4>

<pre class="prettyprint prettyprinted" style=""><code class="language-javascript"><span class="kwd">function</span><span class="pln"> curry</span><span class="pun">(</span><span class="pln">fn</span><span class="pun">){</span><span class="pln">
    </span><span class="kwd">var</span><span class="pln"> slice </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Array</span><span class="pun">.</span><span class="pln">prototype</span><span class="pun">.</span><span class="pln">slice</span><span class="pun">,</span><span class="pln">
        args </span><span class="pun">=</span><span class="pln"> slice</span><span class="pun">.</span><span class="pln">call</span><span class="pun">(</span><span class="pln">arguments</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">function</span><span class="pun">(){</span><span class="pln">
        </span><span class="kwd">return</span><span class="pln"> fn</span><span class="pun">.</span><span class="pln">apply</span><span class="pun">(</span><span class="kwd">null</span><span class="pun">,</span><span class="pln"> args</span><span class="pun">.</span><span class="pln">concat</span><span class="pun">(</span><span class="pln">slice</span><span class="pun">.</span><span class="pln">call</span><span class="pun">(</span><span class="pln">arguments</span><span class="pun">)));</span><span class="com">//合并任意参数</span><span class="pln">
    </span><span class="pun">};</span><span class="pln">
</span><span class="pun">}</span></code></pre>

<h4 id="七函数沙箱模式">七、函数沙箱模式</h4>

<pre class="prettyprint prettyprinted" style=""><code class="language-javascript"><span class="kwd">function</span><span class="pln"> </span><span class="typ">SandBox</span><span class="pun">(){</span><span class="pln"> </span><span class="com">//参数有三种类型('dom','event',callback),('*', callback), (callback)</span><span class="pln">
    </span><span class="kwd">var</span><span class="pln"> args </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Array</span><span class="pun">.</span><span class="pln">prototype</span><span class="pun">.</span><span class="pln">slice</span><span class="pun">.</span><span class="pln">call</span><span class="pun">(</span><span class="pln">arguments</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">var</span><span class="pln"> callback </span><span class="pun">=</span><span class="pln"> args</span><span class="pun">.</span><span class="pln">pop</span><span class="pun">();</span><span class="pln"> </span><span class="com">// 分离出callback</span><span class="pln">
    </span><span class="kwd">var</span><span class="pln"> models </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">args</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> </span><span class="kwd">typeof</span><span class="pln"> args</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]</span><span class="pln"> </span><span class="pun">===</span><span class="pln"> </span><span class="str">'string'</span><span class="pun">)</span><span class="pln"> </span><span class="pun">?</span><span class="pln"> args </span><span class="pun">:</span><span class="pln"> args</span><span class="pun">[</span><span class="lit">0</span><span class="pun">];</span><span class="pln"> </span><span class="com">//取出正确的模块名字，models类型为数组</span><span class="pln">
    </span><span class="kwd">if</span><span class="pun">(!(</span><span class="kwd">this</span><span class="pln"> </span><span class="kwd">instanceof</span><span class="pln"> </span><span class="typ">SandBox</span><span class="pun">))</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><span class="com">// 强制使用new</span><span class="pln">
        </span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">SandBox</span><span class="pun">(</span><span class="pln">args</span><span class="pun">,</span><span class="pln"> callback</span><span class="pun">);</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">if</span><span class="pun">(!</span><span class="pln">models </span><span class="pun">||</span><span class="pln"> models</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]</span><span class="pln"> </span><span class="pun">===</span><span class="pln"> </span><span class="str">'*'</span><span class="pun">){</span><span class="pln"> </span><span class="com">//如果为后两种参数类型，则加载全部模块</span><span class="pln">
        models </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[];</span><span class="pln">
        </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">var</span><span class="pln"> i </span><span class="kwd">in</span><span class="pln"> </span><span class="typ">SandBox</span><span class="pun">.</span><span class="pln">models</span><span class="pun">){</span><span class="pln">
            </span><span class="kwd">if</span><span class="pun">(</span><span class="typ">SandBox</span><span class="pun">.</span><span class="pln">models</span><span class="pun">.</span><span class="pln">hasOwnProperty</span><span class="pun">(</span><span class="pln">i</span><span class="pun">)){</span><span class="pln">
                models</span><span class="pun">.</span><span class="pln">push</span><span class="pun">(</span><span class="pln">i</span><span class="pun">);</span><span class="pln">
            </span><span class="pun">}</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="pln">i </span><span class="pun">=</span><span class="pln"> models</span><span class="pun">.</span><span class="pln">length</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">--;){</span><span class="pln">
        </span><span class="typ">SandBox</span><span class="pun">.</span><span class="pln">models</span><span class="pun">[</span><span class="pln">models</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]](</span><span class="kwd">this</span><span class="pun">);</span><span class="pln"> </span><span class="com">// 运行模块</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    callback</span><span class="pun">(</span><span class="kwd">this</span><span class="pun">);</span><span class="pln"> </span><span class="com">// 运行callback</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="typ">SandBox</span><span class="pun">.</span><span class="pln">models </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{};</span><span class="pln"> </span><span class="com">// 模块存储位置</span><span class="pln">
</span><span class="typ">SandBox</span><span class="pun">.</span><span class="pln">models</span><span class="pun">.</span><span class="pln">dom </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">function</span><span class="pun">(</span><span class="pln">box</span><span class="pun">){</span><span class="pln">
    box</span><span class="pun">.</span><span class="kwd">get</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">function</span><span class="pun">(){};</span><span class="pln">
    box</span><span class="pun">.</span><span class="kwd">set</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">function</span><span class="pun">(){};</span><span class="pln">
</span><span class="pun">};</span><span class="pln">
</span><span class="typ">SandBox</span><span class="pun">.</span><span class="pln">models</span><span class="pun">.</span><span class="kwd">event</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">function</span><span class="pun">(</span><span class="pln">box</span><span class="pun">){</span><span class="pln">
    box</span><span class="pun">.</span><span class="pln">addEvent </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">function</span><span class="pun">(){};</span><span class="pln">
    box</span><span class="pun">.</span><span class="pln">removeEvent </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">function</span><span class="pun">(){};</span><span class="pln">
</span><span class="pun">};</span><span class="pln">
</span><span class="com">// ...</span></code></pre>

<h4 id="八method方法">八、method方法</h4>

<pre class="prettyprint prettyprinted" style=""><code class="language-javascript"><span class="kwd">if</span><span class="pun">(</span><span class="kwd">typeof</span><span class="pln"> </span><span class="typ">Function</span><span class="pun">.</span><span class="pln">prototype</span><span class="pun">.</span><span class="pln">method </span><span class="pun">!==</span><span class="pln"> </span><span class="str">'function'</span><span class="pun">){</span><span class="pln"> </span><span class="com">// 如果不存在该方法</span><span class="pln">
    </span><span class="typ">Function</span><span class="pun">.</span><span class="pln">prototype</span><span class="pun">.</span><span class="pln">method </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">function</span><span class="pun">(</span><span class="pln">name</span><span class="pun">,</span><span class="pln"> fn</span><span class="pun">){</span><span class="pln">
        </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">prototype</span><span class="pun">[</span><span class="pln">name</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> fn</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">this</span><span class="pun">;</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span></code></pre>

<h4 id="九dom查找">九、DOM查找</h4>

<h4 id="前一个兄弟节点">1.前一个兄弟节点</h4>

<pre class="prettyprint prettyprinted" style=""><code class="language-javascript"><span class="kwd">function</span><span class="pln"> prev</span><span class="pun">(</span><span class="pln">ele</span><span class="pun">){</span><span class="pln">
    ele </span><span class="pun">=</span><span class="pln"> ele</span><span class="pun">.</span><span class="pln">previousSibling</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> ele</span><span class="pun">.</span><span class="pln">nodeType </span><span class="pun">===</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="pun">?</span><span class="pln"> ele </span><span class="pun">:</span><span class="pln"> prev</span><span class="pun">(</span><span class="pln">ele</span><span class="pun">);</span><span class="pln">
</span><span class="pun">}</span></code></pre>

<h5 id="后一个兄弟节点">2.后一个兄弟节点</h5>

<pre class="prettyprint prettyprinted" style=""><code class="language-javascript"><span class="kwd">function</span><span class="pln"> </span><span class="kwd">next</span><span class="pun">(</span><span class="pln">ele</span><span class="pun">){</span><span class="pln">
    ele </span><span class="pun">=</span><span class="pln"> ele</span><span class="pun">.</span><span class="pln">nextSibling</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> ele</span><span class="pun">.</span><span class="pln">nodeType </span><span class="pun">===</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="pun">?</span><span class="pln"> ele </span><span class="pun">:</span><span class="pln"> </span><span class="kwd">next</span><span class="pun">(</span><span class="pln">ele</span><span class="pun">);</span><span class="pln">
</span><span class="pun">}</span></code></pre>

<h5 id="getelementsbyclassname实现">3.getElementsByClassName实现</h5>

<pre class="prettyprint prettyprinted" style=""><code class="language-javascript"><span class="kwd">function</span><span class="pln"> getElementsByClassName</span><span class="pun">(</span><span class="pln">clsName</span><span class="pun">,</span><span class="pln"> context</span><span class="pun">){</span><span class="pln">
    </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">document</span><span class="pun">.</span><span class="pln">getElementsByClassName</span><span class="pun">){</span><span class="pln"> </span><span class="com">// 委托给浏览器</span><span class="pln">
        </span><span class="kwd">return</span><span class="pln"> context</span><span class="pun">.</span><span class="pln">getElementsByClassName</span><span class="pun">(</span><span class="pln">clsName</span><span class="pun">);</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">var</span><span class="pln"> ret </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[];</span><span class="pln">
    context </span><span class="pun">=</span><span class="pln"> context </span><span class="pun">||</span><span class="pln"> document</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">var</span><span class="pln"> total </span><span class="pun">=</span><span class="pln"> context</span><span class="pun">.</span><span class="pln">getElementsByTagName</span><span class="pun">(</span><span class="str">'*'</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">var</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln"> len </span><span class="pun">=</span><span class="pln"> total</span><span class="pun">.</span><span class="pln">length</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> len</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">++){</span><span class="pln">
        </span><span class="kwd">var</span><span class="pln"> classNames </span><span class="pun">=</span><span class="pln"> total</span><span class="pun">[</span><span class="pln">i</span><span class="pun">].</span><span class="pln">className</span><span class="pun">.</span><span class="pln">split</span><span class="pun">(</span><span class="str">' '</span><span class="pun">);</span><span class="pln">
        </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">var</span><span class="pln"> j </span><span class="pun">=</span><span class="pln"> classNames</span><span class="pun">.</span><span class="pln">length</span><span class="pun">;</span><span class="pln"> j </span><span class="pun">--;){</span><span class="pln">
            </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">classNames</span><span class="pun">[</span><span class="pln">j</span><span class="pun">]</span><span class="pln"> </span><span class="pun">===</span><span class="pln"> clsName</span><span class="pun">){</span><span class="pln">
                ret</span><span class="pun">.</span><span class="pln">push</span><span class="pun">(</span><span class="pln">total</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]);</span><span class="pln">
            </span><span class="pun">}</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> ret</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span></code></pre>

<h4 id="十windowonload合并">十、window.onload合并</h4>

<pre class="prettyprint prettyprinted" style=""><code class="language-javascript"><span class="kwd">function</span><span class="pln"> addLoadEvent</span><span class="pun">(</span><span class="pln">fn</span><span class="pun">){</span><span class="pln">
    </span><span class="kwd">var</span><span class="pln"> old </span><span class="pun">=</span><span class="pln"> window</span><span class="pun">.</span><span class="pln">onload</span><span class="pun">;</span><span class="pln">
    window</span><span class="pun">.</span><span class="pln">onload </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">typeof</span><span class="pln"> old </span><span class="pun">!==</span><span class="pln"> </span><span class="str">'function'</span><span class="pun">)</span><span class="pln"> </span><span class="pun">?</span><span class="pln"> fn </span><span class="pun">:</span><span class="pln"> </span><span class="kwd">function</span><span class="pun">(){</span><span class="pln"> </span><span class="com">// 合并已有的onload</span><span class="pln">
        old</span><span class="pun">();</span><span class="pln">
        fn</span><span class="pun">();</span><span class="pln">
    </span><span class="pun">};</span><span class="pln">
</span><span class="pun">}</span></code></pre>

  </div>
</div>
<footer>
  <div class="container">
    <p>&copy; Stenders.github.io@2014</p>
  </div>
</footer>
<a href="javascript:;" class="gotop"><i class="fa fa-arrow-circle-o-up"></i></a>
<!-- <script type="text/javascript" src="/js/jquery-1.10.min.js"></script>
<script type="text/javascript" src="/js/bootstrap.min.js"></script>
<script type="text/javascript" src="/js/main.js"></script> -->
<script type="text/javascript" src="/js/posts.js"></script>
<script type="text/javascript">
var _bdhmProtocol = (("https:" == document.location.protocol) ? " https://" : " http://");
document.write(unescape("%3Cscript src='" + _bdhmProtocol + "hm.baidu.com/h.js%3F062a4b4393b5b26e1db637b7504e8737' type='text/javascript'%3E%3C/script%3E"));
</script>
</body>
</html>